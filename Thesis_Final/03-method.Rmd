---
title: Methods
author: Author
chapter: 3
in_context: False
knit: iheiddown::chapter_pdf
output: iheiddown::chapter_pdf
---

```{r intialize, echo=FALSE}
# Setting chunk opts

# Libraries
library(skimr)
library(tidyverse)
library(gridExtra)
library(kableExtra)
library(tidygraph)
library(ggraph)

# Set paths
project_path <- substr(getwd(), 1, 56)
graph_path <- paste0(project_path, "/graphs/")
ecolex_path <- paste0(project_path, "/data/ECOLEX/Membership/ECOLEX_Membership.rds")
onemodenetpath <- paste0(project_path, "/data/CleanData/OnemodeNetworks/")
clean_data_path <- paste0(project_path, "/data/CleanData/")
```

\setcounter{chapter}{2}
# Methodology and Data {#methodsdata}

This section will outline the computation of a novel set of centrality measures
which will be used in the subsequent analysis to proxy the relative importance
of countries within the international environmental governance complex and
account for the increasing importance of international policy to tackle
environmental challenges. In what follows, we will describe the construction
of the bipartite membership network of international agreements^[Note that we
interchangeably use bimodal and bipartite as adjectives to qualify the nature
of the original membership network. The original network is both bimodal,
since it has two different types of agreements, and bipartite since it does
not have links between two nodes of the same type.
[@borgatti20092]] and the
extraction of a monopartite cooperation network which defines links between countries
as the number of agreements that have been signed in common. We then
statistically validate this projection by comparing the resulting observed
one cooperation network with a null model. This process is also commonly
known as *backbone extraction*. Finally, we describe the computation of
two centrality indices that will proxy the intensity and the certainty of
international policy. Let us start by defining the empirical panel model that
we will estimate in the next section before detailing the construction of
the various estimated coefficients.

## The Empirical Model:

We define a panel model and consider all OECD countries (as of 2021)
over the time period between 1990 and 2015.

$$
y_{it} = \beta_1 \text{EPS}_{it} + \beta_2 \text{Strength}_{it} +
\beta_3 \text{WeightedClustering}_{it} + \beta_4 X_{it} + \alpha_i + \delta_t + u_{it}
$$



## Constructing international environmental cooperation centrality measures:

We leverage the ECOLEX dataset to construct country level measures of
embeddedness in the international environmental cooperation network
[@unepiucnfaoECOLEXGatewayEnvironmental2022]^[To be more specific, we use a 
pre-scraped version included in the `{manyenviron}` package 
[@hollwayManyenvironEnvironmentalAgreements2021] which was originally used in
@sommerGlobalGovernanceForestry2020]. This dataset lists
environmental agreements between two or more parties and the related
membership actions over the period between 1868 and 2018 and contains over
25000 individual membership actions.^[See Table \@ref(tab:ECOLEX) describing
the structure of the dataset and displaying the first few observations.]
We follow @carattiniWhatDoesNetwork2021
and retain agreements that were signed in the Post-war period starting in
1948. We retain 21270 individual membership actions after filtering out
agreements signed before 1948. After further cleaning the data by excluding
observations on which we do not have identifying information such as the date of
the ratification of the agreement and the date of entry into force or the
country which is the subject of the membership action, we retain 18878
individual membership actions that describe 521 individual international
environmental agreements.

```{r ECOLEX, echo=FALSE, results='asis', fig.pos = 'h'}
load(ecolex_path)
# Remove unsigned
ECOLEX_mems <- ECOLEX_mems %>%
  dplyr::filter(!is.na(Force)) %>%
  dplyr::select(ecolexID, treatyID, CountryID, Title, Beg, End,
                SignatureCountry, Rat, Force, DocType, GeogArea, Subject)
# Create table
kableExtra::kbl(head(ECOLEX_mems, 20),
                caption = "ECOLEX Dataset Head",
                booktabs = T) %>%
  kableExtra::kable_styling(latex_options = c("striped", "scale_down")) %>%
  kableExtra::landscape()
```

### From a Bipartite Membership Network:

The ECOLEX dataset presented above in \@ref(tab:ECOLEX) can be visualized as
an annual series of undirected, unweighted, bipartite/bimodal networks.
This can be done in the form of a yearly incidence matrix $I_{C \times A}^t$ where each row
corresponds to a country (an agent) and each column to a treaty (an artifact)
[@latapyBasicNotionsAnalysis2008]. The main theoretical difference between the
two sets of nodes is that the former has agency over the links while the latter
does not.^[This distinction will inform the choice of the backbone extraction
algorithm as outlined below.] $i_{ik}^t$ equals $1$
if country $i$ has ratified agreement $k$ which entered into force during or before year
$t$ and $0$ otherwise. A country can only be a member of a treaty once which implies
that $i_{ik}^t \in \{0,1\}$.

```{=latex}
\begin{equation*}
  \begin{rcases}\displaystyle
    I_{ik}^t = \overbrace{\begin{pmatrix}
    i_{1,1}     & i_{1,2}     & i_{1,3}     & \dots     & i_{1,A}           \\
    i_{2,1}     & i_{2,2}     & i_{2,3}     & \dots     & i_{2,A}           \\
    i_{3,1}     & i_{3,2}     & i_{3,3}     & \dots     & i_{3,A}           \\
    \vdots      & \vdots      & \vdots      & \ddots    & \vdots      \\
    i_{C,1}     & i_{C,2}     & i_{C,3}     & \dots     & i_{C,A}
  \end{pmatrix}}^{\text{Agreements}}
  \end{rcases}
    \text{Countries}
\end{equation*}
```

We can also visualize the bipartite/bimodal membership network directly and
distinguish agreements from countries.
The network is depicted in \@ref(fig:ECOLEX_bipartite_network)
represents the membership network with all agreements that entered into force
respectively during the period of 1948 and 1978 and 1948 and 2018. This shows
that the network grew denser as agreements were signed, ratified and entered
into force over time. To explore the intertemporal evolution of
the structure of the network, we will divide this network and construct
yearly snapshots of the membership graph whose incidence matrix we define as
$I_{C \times A}^t$ which is one of the two standard methods used in social network
analysis to account for the intertemporal evolution of a network
[@everettDualprojectionApproachTwomode2013].

```{r ECOLEX_bipartite_network, echo=FALSE, fig.pos = 'h'}
ECOLEX_mems_net1 <- ECOLEX_mems %>%
  dplyr::mutate(Year = as.numeric(format(ECOLEX_mems$Force, format = "%Y"))) %>%
  dplyr::filter(Year <= 1978) %>%
  dplyr::select(ecolexID, CountryID) %>%
  migraph::as_tidygraph(twomode = T) %>%
  dplyr::mutate(Type = ifelse(type, "Country", "Agreement"))
ECOLEX_mems_net2 <- ECOLEX_mems %>%
  dplyr::mutate(Year = as.numeric(format(ECOLEX_mems$Force, format = "%Y"))) %>%
  dplyr::select(ecolexID, CountryID) %>%
  migraph::as_tidygraph(twomode = T) %>%
  dplyr::mutate(Type = ifelse(type, "Country", "Agreement"))
# Graph things
layout_bi1 <- ggraph::create_layout(ECOLEX_mems_net1, layout = "igraph",
                                algorithm = "bipartite")
layout_bi2 <- ggraph::create_layout(ECOLEX_mems_net2, layout = "igraph",
                                algorithm = "bipartite")
plot1 <- ggraph::ggraph(ECOLEX_mems_net1, layout = layout_bi1) +
  ggraph::geom_edge_link(alpha = 0.01) +
  ggraph::geom_node_point(aes(shape = Type, color = Type)) +
  ggplot2::labs(title = "Membership Network 1948-1978") +
  ggplot2::theme_void() +
  theme(legend.position = 'bottom')
plot2 <- ggraph::ggraph(ECOLEX_mems_net2, layout = layout_bi2) +
  ggraph::geom_edge_link(alpha = 0.01) +
  ggraph::geom_node_point(aes(shape = Type, color = Type)) +
  ggplot2::labs(title = "Membership Network 1948-2018") +
  ggplot2::theme_void() +
  theme(legend.position = 'bottom')
# Combine plots
gridExtra::grid.arrange(plot1, plot2, ncol = 2)
```

### To a Monopartite Cooperation Network:

While we could further analyze this
network directly, we will transform it into a more easily interpretable
one mode network by using a projection and retaining only significant edges
through a backbone extraction algorithm. We will thus broadly follow
@carattiniWhatDoesNetwork2021 while ensuring that our results are not contingent
on the backbone extraction algorithm since the theoretical underpinnings of
the latter are still somewhat unclear in empirical social network analysis
[@nealComparingAlternativesFixed2021].

We begin by creating a naive projection of the membership network. To perform
this naive projection we multiply the yearly incidence matrix $I_{c \times a}^t$
defined above by its transposed $I_{A \times C}^t$ as follows:

$$
I_{C \times A}^t I_{A \times C}^t = Adj_{C\times C}^t
$$
Where $Adj_{c\times c}^t$ is the adjacency matrix of the projected cooperation network in
which $Adj_{ij}^t$ is the number of observed co-signed agreements between the two countries
that entered into force in the interval $[1948; t]$. These weights capture
the intensity of the environmental cooperation between two countries much like
@newmanScientificCollaborationNetworks2001 captured collaboration within a
bipartite network of scientific collaboration. Concurrently,
it implies that bilateral treaties, ceteris paribus, carry a greater weight
in the cooperation network than multilateral treaties. This is consistent with
the heterogeneous role both play within the environmental governance network.
As highlighted by @hollwayMultilevelEmbeddednessCase2016, bilateral treaties
are akin to contracts between two parties while multilateral treaties serve
"normative [...] law-making tools". While both types may act as policy stringency
signals, bilateral treaties carry more weight through their specific contractual nature
hence developing a greater policy stringency signal for firms. 

We cannot, however, directly analyze this cooperation network as the resulting
*naive* monopartite network, depicted in the first panel of
\@ref(fig:ECOLEX_monopartite), still suffers from two issues. First, nodes
with larger degrees in the original bipartite membership network
(e.g. agreements with a larger number signatories or
countries having signed a larger number of agreements) will bear stronger
edges in the projected network. In other words,
if *country A* and *country B* are bound by the same 5 agreements and have
each signed 5 agreements in total, they are conceptually "closer" than
*country C* and *country D* who share the membership in 10 agreements but
have each signed a total of 50 agreements
[@borgatti2011analyzing; @latapyBasicNotionsAnalysis2008;
@nealBackboneBipartiteProjections2014;
@saraccoInferringMonopartiteProjections2017]. However in the resulting one-mode
projection, the latter will be weighted more than the former.
The second issue relates to the fact that *naive* projections may lead to the
emergence of spurious cliques in the projection that are due to a node with a
single connection to the opposite layer in the original bipartite network 
[@saraccoInferringMonopartiteProjections2017]. To solve these two common issues,
we leverage what is known as a backbone extraction algorithm to retain only the
statistically significant edges from the naive projection e.g. the edges
that appear more frequently in the projection than expected by a given null
model.

### Correcting the Monopartite Cooperation Network:

We will use the following three distinct backbone extraction methods to ensure
that our results are not the product of the choice of a particular extraction
method alone. This is especially crucial since we do not have a "ground truth"
or a counterfactual monoparite cooperation network to compare the corrected
projection to. All three considered algorithms follow the same process in that they
impose a constraint $M$ on the original bipartite
network and reshuffle the values of the incidence matrix $I_{C \times A}$.^[We
broadly follow the notation used in @nealComparingAlternativesFixed2021
where each backbone extraction method is described in more detail.
Furthermore, we abstract from superscript $t$ to indicate the time period of the network as
we apply the backbone extraction method to each temporal snapshot of the network.]
In other words, we consider the set of all possible permutations of the original
incidence matrix $I_{c \times a}^t$ containing the same countries and treaties
and satisfying the constraint $M$. We call this set $\mathcal{I}^M$
which is consists of the individual permutated matrices $I^*$. The algorithm
then constructs the one-mode projection of $I^*$ as follows: $P^* = I^*\times [I^*]^T$
Recall that when performing the naive projection, we defined $p_{ij}$ as the observed
number of co-signed treaties between country $i$ and country $j$.
To decide whether an edge between $i$ and $j$ should be included in the
backbone of the projected network, the algorithm compares the observed value $p_{ij}^t$
to the simulated one in $P^*$ which we call $p_{ij}^*$. We therefore define
the following two-sided hypothesis test to characterize the presence (or absence)
of a tie $p_{i j}^{B}$ in the backbone $P^B$ based on a significance level $\alpha$.

$$
p_{i j}^{B}=
\begin{cases}1 & \text { if } \operatorname{Pr}\left(p_{i j}^{*} \geq p_{i j}\right)<\frac{\alpha}{2} \\
0 & \text { else }\end{cases}
$$

As described in @nealComparingAlternativesFixed2021, we use a two-tailed test
since we would like to filter out both uncommonly small *and* uncommonly large
collaborative ties in the projection. @nealBackbonePackageExtract2022 point
out that since we perform this hypothesis test for every non-null edge, we
will inflate the Type-I error i.e. include too many false positives in our
corrected graph. ^[The significance level $\alpha$ defines the probability
that a given edge is included in the backbone. Since we run this test over
$e$ edges, the probability that we detect at least one such false positive across our
test equals $1-(1-\alpha)^e$ which is strictly increasing in the number of tests
$e$.] Following @nealBackbonePackageExtract2022, we therefore leverage the
False Discovery Rate multiple test correction
method which sorts the observed p-values in an increasing order before retaining
all edges with a p-value satisfying $\text{P-value}_{d}\leq \frac{d}{m} \alpha$
where $d \in \{1,\dots, e\}$ for all backbone extraction methods
[@benjaminiControllingFalseDiscovery1995].

Finally, this hypothesis test yields a binary correction
matrix which informs us whether to keep a tie in the naive projection or not and
thereby solves both issues of the naive projection described above.
Now that we have a general understanding of the process
of a backbone extraction algorithm, we turn to the following three subsections
which will focus on the differences between the
different algorithms that lie in the nature of the constraint they
impose on the simulated networks. We will thus consider in turn the
Fixed Row Model, the Fixed Degree Sequence Model, and the Stochastic Degree
Sequence Model.

#### Fixed Degree Sequence Model:

The Fixed Degree Sequence Model (FDSM) is a microcanonical backbone extraction
method in that the constraint that it imposes on the set of possible permutations
$\mathcal{I}^{FDSM}$ is satisfied *exactly*.^[This stands in opposition to
canonical extraction algorithm that impose the constraint only *on average*.]
More specifically, the FDSM algorithm sets the degrees of each agent and
each artifact to be equal to the degree sequences of the observed network.
In our context, it implies that the row and column sums of the simulated $I_{ik}^*$
are to be equal to those of the observed network $I_{ik}$ under the FDSM algorithm. 

$$
  I_{ik}^* = 
\begin{blockarray}{cccccc}
\begin{block}{(ccccc)c}
  1 & 1 & 1 & \dots & 1 & \sum_{k = 1}^{A} i_{1k} \\
  0 & 1 & 0 & \dots & 1 & \sum_{k = 1}^{A} i_{2k} \\
  0 & 0 & 1 & \dots & 1 & \sum_{k = 1}^{A} i_{3k} \\
  0 & 1 & 0 & \dots & 1 & \sum_{k = 1}^{A} i_{4k} \\
  \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
  0 & 1 & 0 & \dots & 1 & \sum_{k = 1}^{A} i_{Ck} \\
\end{block}
\sum_{i = 1}^{C} i_{i1} & \sum_{i = 1}^{C} i_{i2} & \sum_{i = 1}^{C} i_{i3} & \dots & \sum_{i = 1}^{C} i_{iA} \\
\end{blockarray}
$$

As @nealComparingAlternativesFixed2021 point out, the main advantage of this
method is that it is able to alleviate the two issues plaguing our *naive projection* outlined
above by controlling for the vector of degrees. Intuitively,
we retain the cooperative edges that occur more often than expected by the
null model in the observed projection.^[@vasquesfilhoTransitivityDegreeAssortativity2020,
degree sequences of the bipartite
network are chiefly responsive for the structure of its monopartite projection.]
The main disadvantage of such an algorithm is that it is ill suited for large
bipartite networks due the computational complexity of the algorithm
[@nealComparingAlternativesFixed2021]. A set of alternative models has been developed
to alleviate this computational issue, among which are the Fixed Row Model
and the Stochastic Degree Sequence Model which we define below.

#### Fixed Row Model:

Like the FDSM, the Fixed Row Model (FRM) is also a microcanonical algorithm.
However, the main difference is that it imposes the degree sequence constraint
on the row sums of the incidence matrix only.^[E.g.
$$
\forall_{i \in \{1,...,C\}} \sum_{k = 1}^{A} i_{ik} = \forall_{i \in \{1,...,C\}} \sum_{k = 1}^{A} 
i_{ik}^*
$$
]
^[The FRM model is also sometimes referred to as the hypergeometric
model [@tumminelloStatisticallyValidatedNetworks2011].]
That is, the degree of every *agent*/country is strictly controlled for, which
implies that in all simulated networks, a country will be bound by the same
number of agreements than in the observed network. However, an agreement
is free to have a different number of total signatories. This leads us to the
reason why we are not considering the Fixed Column Model: agency. Recall that
we previously defined two distinct sets of nodes depending on whether or not
the nodes posses agency over the links they would like to create or dissolve.
Since agreements do not have agency and are constructed through the will
of countries, we constrain the latter's degree only.
@carattiniWhatDoesNetwork2021 applied the Bipartite Partial Configuration Model
which is the canonical version of the FRM algorithm, to their membership network
[@saraccoInferringMonopartiteProjections2017].
This implies that the restriction imposed on the degree sequence of countries
is only satisfied *on average* over all simulations.
Since our membership network is small enough to
be corrected by applying the more computationally intensive FRM algorithm, we
follow the latter as it carries more information about the structure of the
original bipartite network than the BiPCM algorithm
[@saraccoInferringMonopartiteProjections2017].

#### Stochastic Degree Sequence Model:

The Stochastic Degree Sequence Model (SDSM) is a canonical algorithm that
imposes a constraint on both the degree sequence of countries and on the
degree sequence of agreements like the FDSM extraction method. However,
the set of simulated networks satisfy this constraint only *on average*.
In our case, this implies that the average number of member countries
in a given international agreement $k$ in the set of simulated networks is equal
to the number of countries in the observed membership network. Conversely,
it also implies that the average number of agreements signed by a given country
$i$ in the set of simulated networks is equal to the average number of agreements
signed by country $i$ in the observed network. Several methods exist to
simulate networks satisfying this constraint which are compared in terms of
accuracy and computational speed in @nealComparingAlternativesFixed2021.
The authors show that the Bipartite Configuration Model (BICM) is both the
fastest and most accurate method to generate simulated network satisfying
the average condition [@saraccoInferringMonopartiteProjections2017]. We thus
leverage it as our third and last backbone extraction model.

#### Comparing the Projections:

Before moving on to the definition of the various centrality measures we
will use to measure the level of international embeddedness of countries
within the network of international environmental agreements, we will compare
the resulting corrected projections. We namely see that the correction
of performed by the FROW backbone extraction process retains about 90 percent of the
edges of the naive projection which leads to an overly dense network. We
will therefore not consider it in the further analysis as it does not solve
the two issues which we try to correct. This is consistent with Carattini et al.
who mention that their BiPCM-corrected cooperation network's density is so high that
almost every node is connected to each other [@carattiniWhatDoesNetwork2021].
On the other hand, both the
SDSM and the FDSM retain on average about 15 percent of the most significant
edges present in the naive projection. This ensures that we capture the true
cooperative network and not a statistical artifact caused by the two issues
we are trying to correct for. We will therefore compute the centrality scores
on the basis of the latter two corrected networks.

```{r ComparingBackbones}
# Load different networks 2015
Naive <- tidygraph::as_tbl_graph(readRDS(paste0(onemodenetpath, 
                                                "Onemode_Network_Naive_2010.rds")))
FDSM <- tidygraph::as_tbl_graph(readRDS(paste0(onemodenetpath, 
                                               "Onemode_Network_FDSM_NonFDR_2010.rds")))
FROW <- tidygraph::as_tbl_graph(readRDS(paste0(onemodenetpath, 
                                               "Onemode_Network_FROW_2010.rds")))
SDSM <- tidygraph::as_tbl_graph(readRDS(paste0(onemodenetpath, 
                                               "Onemode_Network_SDSM_2010.rds")))

# Graph things
layout_naive <- ggraph::create_layout(Naive, layout = "igraph",
                                algorithm = "lgl")
layout_FROW <- ggraph::create_layout(FROW, layout = "igraph",
                                algorithm = "lgl")
layout_SDSM <- ggraph::create_layout(SDSM, layout = "igraph",
                                algorithm = "lgl")
layout_FDSM <- ggraph::create_layout(FDSM, layout = "igraph",
                                algorithm = "lgl")
Naive_plot <- ggraph::ggraph(Naive, layout = layout_naive) +
  ggraph::geom_edge_link(alpha = 0.01) +
  # ggraph::geom_node_label(aes(label = name), repel = T) +
  ggplot2::labs(title = "Cooperation Network Naive",
                caption = "ECOLEX, 1948-2010") +
  ggplot2::theme_void()
FROW_plot <- ggraph::ggraph(FROW, layout = layout_FROW) +
  ggraph::geom_edge_link(alpha = 0.01) +
  # ggraph::geom_node_label(aes(label = name), repel = T) +
  ggplot2::labs(title = "Cooperation Network FROW",
                caption = "ECOLEX, 1948-2010") +
  ggplot2::theme_void()
SDSM_plot <- ggraph::ggraph(SDSM, layout = layout_SDSM) +
  ggraph::geom_edge_link(alpha = 0.01) + 
  # ggraph::geom_node_label(aes(label = name), repel = T) +
  ggplot2::labs(title = "Cooperation Network SDSM",
                caption = "ECOLEX, 1948-2010") +
  ggplot2::theme_void()
FDSM_plot <- ggraph::ggraph(FDSM, layout = layout_FDSM) +
  ggraph::geom_edge_link(alpha = 0.01) +
  ggplot2::labs(title = "Cooperation Network FDSM",
                caption = "ECOLEX, 1948-2010") +
  ggplot2::theme_void() +
  theme(legend.position = 'bottom')
# Combine plots
gridExtra::grid.arrange(Naive_plot, FROW_plot,
                        SDSM_plot, FDSM_plot,
                        ncol = 2)
```

### Selecting and Computing Network Centrality Measures:

Now that we constructed and corrected the monopartite cooperation networks,
we can characterize the topological position of a given country within the
network and construct proxies for the *embeddedness* of a country in the
international environmental governance complex. While there exist a multitude
of centrality indices to characterize the position of a country
and no unifying theoretical framework for defining it, we will
consider the commonly used strength centrality measure and the
eigenvector centrality measure which we will theoretically justify in turn.

#### Strength Centrality:

The strength of a node in an undirected and unweighted network measures the
number of ties emanating from a node and weights them by their respective
weights as follows:

$$
s_{i}=\sum_{j=1}^{N} a_{i j} w_{i j}
$$
Strength centrality echoes the proxy @jahnPoliticsEnvironmentalPerformance2016
used to measure embeddedness in the
international governance complex in that it captures the sum of
cooperative ties of a given country within the weighted network of ties. Hence
we expect that a country with a higher level of strength, ceteris paribus,
will be more embedded in the international environmental agreement network.
As stated in the previous chapter, we expect that this increased embeddedness
leads to an increase in environmental innovation through both direct effects
of the international policy framework and the indirect effects of a greater
policy certainty. While we cannot distinguish both channels in this study,
we expect that the node strength captures a relatively greater share of 
the direct effects of the increased embeddedness on innovation as
it measures the quantity of agreement a country is bound by. The opposite
can be said of the eigenvector centrality measure we define below.

#### Transitivity:

The weighted clustering coefficient extends the notion of embeddedness by
computing the weighted proportion of triangles over connected triples
that are centered on a given node [@barratArchitectureComplexWeighted2004].
On the illustration below, we see that
the figure on the right is an open triple from the point of view of the orange
node but not a triangle as opposed to the figure on the right. If we abstract
from the weights, it is easy to see that the clustering coefficient,
also known as transitivity, of the orange node on the left figure is
equal to 1 while the transitivity of the orange node on the right hand side figure
is 0.

```{r transitivitygraph, echo=FALSE, fig.cap = "Transitivity"}
knitr::include_graphics("figures/Transitivity.png")
```

Mathematically, @barratArchitectureComplexWeighted2004 define the weighted index as follows
where $w_{i j}$ is the weight of the link between node $i$ and node $j$,
$a_{ij}$ is a binary variable indicating the presence of an edge between $i$ and $j$,
$s_i$ is the strength of node $i$, and $k_i$ is the node's degree.

$$
c_{i}^{w}=\frac{1}{s_{i}\left(k_{i}-1\right)} \sum_{j, h} \frac{\left(w_{i j}+w_{i h}\right)}{2} a_{i j} a_{i h} a_{j h} \in [0;1]
$$

In our international cooperation network, we can interpret this coefficient
as the local empirical reflection of closure which is a characteristic of
a network where agents have a low level of information asymmetry with regards
of the actions undertaken by each node over time [@colemanSocialCapitalCreation1988].
This facilitated monitoring favors the application of sanctions if an agent defects
as well as the emergence of a virtuous cycle of trust and further cooperation
[@burtNetworkStructureSocial2000].
This virtuous cycle echoes both arguments in sociology by
@granovetterEconomicActionSocial1985 who posits that the cost of breaking a
friends trust and therefore the friendship is greater when both agents have a
friend in common since the betrayal may also affect one's relationship with the
latter. This argument has been made concurrently in the field of economics and
especially within the game theoretical analysis of repeated games
[@tullockAdamSmithPrisoners1985] and within the empirical analysis of
reputation in medieval trading [@greifReputationCoalitionsMedieval1989].
The main insight in our case of international cooperation is therefore
that countries with a higher transitivity index will have a higher cost of
defecting. This in turn leads to a higher level of trust within the network,
and crucially in our case, a higher level of economic policy certainty which
we hypothesize is favorable to the process of green innovation.

## Other variables:

### Environmental Policy Stringency Index:

The Environmental Policy Stringency Index (EPS) is an index created by the OECD
which measures the stringency of environmental policy at the country level
during the period of 1990 to 2015 [@bottaMeasuringEnvironmentalPolicy2014].
As pointed out in the literature on environmental policy and innovation by
@poppEnvironmentalPolicyInnovation2019, the  
index is often used as an empirical proxy to measure environmental policy in
the literature including in studies examining Porter's Hypothesis
[@galeottiMeasuringEnvironmentalPolicy2020;
@martinez-zarzosoDoesEnvironmentalPolicy2019]. While we refer the reader
to the original paper by @bottaMeasuringEnvironmentalPolicy2014 for a detailed
description of the construction of the index, we can summarize it as follows.
The basis of the EPS index are individual indices of policy stringency such
as emission taxes, trading schemes, environmental standards, and governmental
R&D subsidies. These individual policy categories are then given a ranking
on a Lickert scale between 0 and 6 before being aggregated into market and
non-market based policies. These two subsets are then once again equally
aggregated into the composite EPS index with equal weights which provides us
with a reliable country level measure of aggregate domestic environmental policy.
Overall, one can discern a positive trend in the stringency level over the
considered period for every country indicating the implementation of more
stringent environmental policies.

```{r EPSdesc, echo=FALSE, fig.cap="Environmental Policy Stringency 1990-2015", warning=FALSE, message=FALSE}
readRDS(paste0(clean_data_path, "Panel.rds")) %>%
  ggplot2::ggplot(aes(x = Year, y = EPS)) +
  ggplot2::geom_line(aes(color = COU), size = 0.6) +
  ggplot2::guides(color = guide_legend(title = "Country")) +
  ggplot2::labs(caption = "OECD, 2015") +
  iheiddown::theme_iheid()
```

### Innovation Measures:

We measure innovation in two main ways. First, we consider the business
expenditures on R&D to capture the input side of the innovation process
by using the 


#### Business Expenditures in R&D:

```{r BERDdesc, echo=FALSE, fig.cap="Business Expenditures in R&D 1990-2015", warning=FALSE, message=FALSE}
readRDS(paste0(clean_data_path, "Panel.rds")) %>%
  ggplot2::ggplot(aes(x = Year, y = log(berd))) +
  ggplot2::geom_line(aes(color = COU), size = 0.6) +
  ggplot2::guides(color = guide_legend(title = "Country")) +
  ggplot2::labs(caption = "OECD, 2021",
                y = "log(BERD)") +
  iheiddown::theme_iheid()
```

#### Triadic Patent Counts:

```{r TPFdesc, echo=FALSE, fig.cap="Triadic Patent Counts 1990-2015", warning=FALSE, message=FALSE}
readRDS(paste0(clean_data_path, "Panel.rds")) %>%
  ggplot2::ggplot(aes(x = Year, y = triadic_patent)) +
  ggplot2::geom_line(aes(color = COU), size = 0.6) +
  ggplot2::guides(color = guide_legend(title = "Country")) +
  ggplot2::labs(caption = "OECD, 2021",
                y = "Triadic Patent Count") +
  iheiddown::theme_iheid()
```

#### Environmental Patent Counts:

```{r TPFdesc, echo=FALSE, fig.cap="Triadic Patent Counts 1990-2015", warning=FALSE, message=FALSE}
readRDS(paste0(clean_data_path, "Panel.rds")) %>%
  ggplot2::ggplot(aes(x = Year, y = EnvPat)) +
  ggplot2::geom_point(aes(color = COU), size = 1) +
  ggplot2::guides(color = guide_legend(title = "Country")) +
  ggplot2::labs(caption = "OECD, 2021",
                y = "Environmental Patent Count") +
  iheiddown::theme_iheid()
```

### Productivity Measures:

#### Total Factor Productivity:

https://euklems.eu/

$$
\Delta \ln Y=\Delta \ln T F P 0+\bar{s}_{C} \Delta \ln K+\bar{s}_{L} \Delta \ln H
$$

```{r TFP0desc, echo=FALSE, fig.cap="Total Factor Productivity 1990-2015", warning=FALSE, message=FALSE}
readRDS(paste0(clean_data_path, "Panel.rds")) %>%
  ggplot2::ggplot(aes(x = Year, y = TFP0)) +
  ggplot2::geom_line(aes(color = COU), size = 0.6) +
  ggplot2::guides(color = guide_legend(title = "Country")) +
  ggplot2::labs(caption = "EU KLEMS, 2022",
                y = "Total Factor Productivity\n(growth rate %)") +
  ggplot2::xlim(1995, 2015) +
  iheiddown::theme_iheid()
```


### Other Control Variables:

GDP per capita, Import intensity, Export intensity

## Correlations:

Before moving on to the results, let us consider the correlations between
our variables of interest.

```{r correlations, echo=FALSE, fig.cap="Correlations"}
knitr::include_graphics("figures/Correlations.png")
```
